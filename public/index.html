<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ジャン富豪ライン - 4人打ち</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div id="login-overlay" class="modal-overlay">
    <div id="login-modal" class="modal-content">
      <h3>プレイヤー名を入力してください</h3>
      <input type="text" id="player-name-input" maxlength="10" placeholder="名前 (10文字まで)">
      <button id="join-game-btn">CPUと対戦開始</button>
    </div>
  </div>
  
  <button id="rule-button">？</button>

  <h1>ジャン富豪ライン (4人打ち)</h1>

  <div id="mahjong-table">
    <div id="player-top" class="player-area">
      <div id="player-info-2" class="player-info">
        <span class="player-hand-info"></span><span class="player-score">25000</span>
      </div>
      <div class="hand-furo-wrapper horizontal">
        <div id="furo-2" class="furo-container horizontal"></div>
        <div id="hand-2" class="hand-container horizontal"></div>
      </div>
      <div id="discard-2" class="discard-row"></div>
    </div>

    <div id="player-left" class="player-area">
      <div id="player-info-3" class="player-info">
        <span class="player-hand-info"></span><span class="player-score">25000</span>
      </div>
      <div class="hand-furo-wrapper vertical">
        <div id="hand-3" class="hand-container vertical"></div>
        <div id="furo-3" class="furo-container vertical"></div>
      </div>
      <div id="discard-3" class="discard-row vertical"></div>
    </div>

    <div id="player-right" class="player-area">
      <div id="player-info-1" class="player-info">
        <span class="player-hand-info"></span><span class="player-score">25000</span>
      </div>
      <div class.hand-furo-wrapper vertical">
        <div id="furo-1" class="furo-container vertical"></div>
        <div id="hand-1" class="hand-container vertical"></div>
      </div>
      <div id="discard-1" class="discard-row vertical"></div>
    </div>
    
    <div id="table-center">
        <div id="revolution-status"></div>
        <div id="timer-display"></div>
        <div id="table-state">
            <div id="round-info">東1局 0本場</div>
            <div id="riichi-sticks">供託: 0本</div>
        </div>
        <div id="game-info">
            <div id="dora-container">
              <span>ドラ: </span>
              <span id="dora-display"></span>
            </div>
            <p id="yama-count"></p>
        </div>
        <div class="center-yaku-display"></div>
    </div>

    <div id="player-bottom" class="player-area">
       <div id="player-info-0" class="player-info">
        <span class="player-hand-info">あなた (東家)</span><span class="player-score">25000</span>
      </div>
      <div class="hand-furo-wrapper horizontal">
        <div id="hand-0" class="hand-container horizontal"></div>
        <div id="furo-0" class="furo-container horizontal"></div>
      </div>
      <div id="discard-0" class="discard-row"></div>
    </div>
  </div>
  
  <div id="tenpai-info-container"></div>
  <p id="info"></p>
  
  <div id="action-buttons">
      <button id="riichi" style="display:none;">リーチ</button>
      <button id="pon" style="display:none;">ポン</button>
      <button id="chi" style="display:none;">チー</button>
      <button id="kan" style="display:none;">カン</button>
      <button id="kyukyu" style="display:none;">九種九牌</button>
      <button id="ron" style="display:none;">ロン</button>
      <button id="skip" style="display:none;">スキップ</button>
  </div>
  
  <div id="result-modal" class="modal-overlay" style="display:none;">
    <div id="yaku-result-content" class="modal-content">
    </div>
  </div>

  <div id="rule-modal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
        <h3>ジャン富豪ライン - 特殊ルール</h3>
        <div class="rule-content">
            <h4>アガリ形式</h4>
            <p>通常の「4面子1雀頭」以外に、牌の枚数が変動するため**「n面子1雀頭」**および**「n対子」**でアガることができます。</p>
            
            <h4>特殊な捨て牌</h4>
            <ul>
                <li><strong><img src="hai/p_ms5_1.gif" class="tile-small"> 5とばし:</strong> 萬子・筒子・索子の5を捨てると、次の人のツモ番を飛ばします。(鳴かれた場合は無効)</li>
                <li><strong><img src="hai/p_ms8_1.gif" class="tile-small"> 8切り:</strong> 萬子・筒子・索子の8を捨てると、もう一度自分のツモ番になります。(鳴かれた場合は無効)</li>
                <li><strong><img src="hai/p_ms9_1.gif" class="tile-small"> 9捨て:</strong> 萬子・筒子・索子の9を捨てると、追加でもう1枚手牌を捨てます。(鳴かれた場合、リーチ中の場合は無効)</li>
                <li><strong><img src="hai/p_ms7_1.gif" class="tile-small"> 7わたし:</strong> 萬子・筒子・索子の7を捨てると、自分の手牌1枚を他のプレイヤーに渡せます。(鳴かれた場合、リーチ中の場合は無効。リーチしている相手には渡せません)</li>
            </ul>

            <h4>革命</h4>
            <p>誰かがカンをすると**「革命」**状態になります。革命中はアガリの点数計算が反転します。</p>
            <ul>
                <li><strong>基本計算:</strong> 14翻 - (元の役の翻数)</li>
                <li>元の翻数が役満(13翻)以上の場合は13翻として計算します。</li>
                <li>ドラの翻数は、革命後の翻数にそのまま加算されます。</li>
                <li>局の合計カン回数が偶数回になると、革命は終了し通常状態に戻ります。</li>
            </ul>
             <div class="modal-footer">
                <button id="close-rule-modal" class="modal-close-btn">閉じる</button>
            </div>
        </div>
    </div>
  </div>

  <div id="special-event-notification"></div>

  <script src="constants.js"></script>
  <script src="yaku.js"></script>
  <script src="ui.js"></script>
  <script src="game.js"></script> 
</body>
</html>